buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.4'
    }
}
plugins {
    id 'java'
    id 'base'
    id 'com.github.johnrengelman.shadow' version '2.0.4'
    id 'checkstyle'
    id 'pmd'
//    id "com.github.spotbugs" version "1.6.3"
}

repositories {
    mavenCentral()
}





wrapper {
    distributionType = Wrapper.DistributionType.ALL
    gradleVersion="4.10"
}

jar.enabled=false



dependencies {
    compile project(":hello")
    compile project(":common")
    compile project(":cypress")
}


allprojects {
    apply plugin: 'java'
//    apply plugin: 'base'

}

task fatJar {
    println "Creating fat jars"
}


subprojects {
    apply plugin: 'com.github.johnrengelman.shadow'
    apply plugin: 'checkstyle'
    apply plugin: 'pmd'
//    apply plugin: "com.github.spotbugs"

    repositories {
        mavenCentral()
    }

    dependencies {

        //useful libraries from google
        compile group: 'com.google.guava', name: 'guava', version: '26.0-jre'

        //libraries for more expressive testing
        testCompile group: 'org.hamcrest', name: 'hamcrest-all', version: '1.3'

        //JUnit should be the same version as spring
        testCompile group: 'junit', name: 'junit', version: '4.12'

        shadowJar { zip64 true }
    }

    task fatJar(dependsOn: shadowJar) {}

    checkstyle {
        configFile = file('../config/checkstyle/checkstyle.xml')
        showViolations=false

    }

    pmd {
        ruleSetFiles = files('../config/pmd/potential-future-pmd.xml')
        ruleSets = []
        ignoreFailures = true //TODO: Remove this when you start fixing your own errors
        toolVersion = '6.7.0'
        consoleOutput=false
    }

//	tasks.withType(com.github.spotbugs.SpotBugsTask) {
//	    reports {
//	        xml.enabled false
//	        html.enabled true
//	        html.stylesheet resources.text.fromFile('../config/spotbugs/spotbugs.xsl')
//	    }
//	}
}

