AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Example Pet Store API written with SpringBoot with the aws-serverless-java-container library

Parameters:
  ProjectId:
    Type: String
    Description: AWS CodeStar projectID used to associate new resources to team members
  Stage:
    Type: String
    Description: Deployment stage. E.g. test, prod, etc.

    # Enable blue/green deployments using this Globals section. For instructions, see the AWS CodeStar User Guide:
    # https://docs.aws.amazon.com/codestar/latest/userguide/how-to-modify-serverless-project.html?icmpid=docs_acs_rm_tr
    #
    # Globals:
    #   Function:
    #     AutoPublishAlias: live
    #     DeploymentPreference:
    #       Enabled: true
    #       Type: Canary10Percent5Minutes



    #Globals:
    #  Api:
    # API Gateway regional endpoints
#    EndpointConfiguration: REGIONAL

Resources:
  CreateDynamoTable:
    Type: AWS::Serverless::Function
    Properties:
      Handler: no.bibsys.handlers.SimpleHandler::handleRequest
      Runtime: java8
      CodeUri: api/build/libs/api-fat.jar
      MemorySize: 1512
      #     Policies are inactive if there is a role attached to the lambda function
      #Policies:
      # - AWSLambdaBasicExecutionRole
      # - CustomDynamoDB_Full_Access
      Role:
        Fn::ImportValue:
          !Join ['-', [!Ref 'ProjectId', !Ref 'AWS::Region', 'LambdaTrustRole']]
      Timeout: 60
      Events:
        GetResource:
          Type: Api
          Properties:
            Path: /{proxy+}
            Method: any
